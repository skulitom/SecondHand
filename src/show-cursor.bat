@echo off
powershell -ExecutionPolicy Bypass -Command "& {Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $form = New-Object System.Windows.Forms.Form; $form.FormBorderStyle = [System.Windows.Forms.FormBorderStyle]::None; $form.Size = New-Object System.Drawing.Size(50, 50); $form.Location = New-Object System.Drawing.Point(400, 300); $form.BackColor = [System.Drawing.Color]::Red; $form.TopMost = $true; $form.ShowInTaskbar = $false; $form.ControlBox = $false; $form.Show(); Write-Host 'Cursor shown at 400,300'; while ($true) { Start-Sleep -Milliseconds 500; if (Test-Path 'C:\temp\cursor_hide.txt') { Remove-Item 'C:\temp\cursor_hide.txt' -Force; break; } if (Test-Path 'C:\temp\cursor_pos.txt') { $pos = Get-Content 'C:\temp\cursor_pos.txt' -Raw -ErrorAction SilentlyContinue; if ($pos) { $coords = $pos.Split(','); if ($coords.Length -eq 2) { $x = [int]$coords[0] - 25; $y = [int]$coords[1] - 25; $form.Location = New-Object System.Drawing.Point($x, $y); Write-Host 'Moved to' $x ',' $y; } } } } $form.Close(); Write-Host 'Cursor hidden'; }"